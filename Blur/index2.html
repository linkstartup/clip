<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>StackBlur Demo</title>
        <link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon" />
    </head>
    <body>
        <h1>StackBlur Demo</h1>
        <img src="sex.jpg" alt="" id='source'>
        <!-- <img src="https://pbs.twimg.com/media/DdAVyyqUwAAGI1U?format=jpg&name=4096x4096" alt="" id='source'> -->
        <canvas id="canvas"  width="1" height="1"></canvas>
        <img src="" alt="" id='theimage'>


    <form ref='uploadForm' 
      id='uploadForm' 
      action='/upload' 
      method='post' 
      encType="multipart/form-data">
        <input type="file" name="sampleFile" />
        <input type='submit' value='Upload!' />
    </form>


<script src="stackblur.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script>


(function() {

StackBlur.image('source', 'canvas', '90',false);

document.getElementById("theimage").src = document.getElementById('canvas').toDataURL();


uploadBase64(document.getElementById("theimage").src)
  function uploadBase64(base64) {
    $.ajax({
      type: "POST",
      url: "/base64",
      data: JSON.stringify({
        base64: base64
      }),
      contentType: "application/json; charset=utf-8",
      crossDomain: true,
      dataType: "json",
      success: function success(data, status, jqXHR) {
        console.log(data)
      }
    });
  }



})();
</script>
    </body>
</html>
